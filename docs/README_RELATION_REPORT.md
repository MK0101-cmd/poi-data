# Relationship Mapping Report Generator

This tool analyzes the pipeline metrics to generate a comprehensive relationship mapping report for the Points of You RAG system.

## üìã What It Does

The report generator analyzes `pipeline_metrics_detailed.json` and produces a detailed report showing:

- **Overall Statistics**: Files analyzed, success rates, relationships found
- **Category Breakdown**: Statistics by Activities vs Trainings
- **Subcategory Analysis**: Detailed breakdown by FACES, FLOW, SPEAK, TCG, etc.
- **Relationship Analysis**: Cross-references between documents
- **Error Analysis**: Failed files and error types
- **Database Schema**: Mapping to PostgreSQL schema
- **Recommendations**: Actionable next steps

## üöÄ Quick Start

### Windows (Double-Click)

Simply **double-click** the batch file:
```
generate_relation_report.bat
```

### Windows (Command Line)

```batch
generate_relation_report.bat
```

### Linux/Mac

```bash
chmod +x generate_relation_report.sh
./generate_relation_report.sh
```

### Python Direct

```bash
python generate_relation_report.py
```

## üìù Usage

### Basic Usage (Default Files)

Generates report from `pipeline_metrics_detailed.json` ‚Üí `RELATIONSHIP_MAPPING_REPORT.md`

**Windows:**
```batch
generate_relation_report.bat
```

**Linux/Mac:**
```bash
./generate_relation_report.sh
```

**Python:**
```bash
python generate_relation_report.py
```

### Custom Input/Output Files

**Windows:**
```batch
generate_relation_report.bat custom_metrics.json custom_report.md
```

**Linux/Mac:**
```bash
./generate_relation_report.sh custom_metrics.json custom_report.md
```

**Python:**
```bash
python generate_relation_report.py custom_metrics.json custom_report.md
```

## üìä Sample Output

```
================================================================================
RELATIONSHIP MAPPING REPORT
================================================================================
Generated: 2025-10-03 18:06:24
Source: pipeline_metrics_detailed.json

EXECUTIVE SUMMARY
--------------------------------------------------------------------------------
Total Files Analyzed:          707
Files Successfully Processed:  702 (99.3%)
Files Failed:                  5 (0.7%)
Files with Relationships:      0
Total Relationships Found:     0
Total Chunks Created:          26
Total Tags Generated:          17
Total Embeddings Created:      0

CATEGORY BREAKDOWN
--------------------------------------------------------------------------------
Category        Files    Chunks   Tags     Embed    Relations
--------------------------------------------------------------------------------
Activities      574      26       17       0        0
Trainings       133      0        0        0        0
...
```

## üîß Requirements

- **Python 3.7+**
- **Input file**: `pipeline_metrics_detailed.json` (generated by the RAG pipeline)

No additional Python packages required - uses only standard library.

## üìÅ Files

| File | Description |
|------|-------------|
| `generate_relation_report.py` | Main Python script |
| `generate_relation_report.bat` | Windows batch file (double-click) |
| `generate_relation_report.sh` | Linux/Mac shell script |
| `RELATIONSHIP_MAPPING_REPORT.md` | Generated report (output) |
| `README_RELATION_REPORT.md` | This documentation |

## üéØ Report Sections

### 1. Executive Summary
High-level statistics about files processed, relationships found, and overall success rate.

### 2. Pipeline Execution
Timing information about the pipeline run including start/end times and duration.

### 3. Category Breakdown
Statistics grouped by main categories (Activities vs Trainings).

### 4. Subcategory Breakdown
Detailed statistics for each collection (FACES, FLOW, SPEAK, TCG, etc.).

### 5. Relationship Analysis
Analysis of cross-references and links between documents. Includes warnings if no relationships found.

### 6. Error Analysis
Detailed breakdown of errors by type with example files.

### 7. Database Schema Mapping
Shows how the relationship data maps to the PostgreSQL `cross_references` table.

### 8. Recommendations
Actionable suggestions for improving relationship detection and data quality.

## üîç Interpreting Results

### ‚úÖ Good Signs
- High success rate (>95%)
- Multiple relationships found
- Embeddings generated successfully
- Chunks and tags created for most files

### ‚ö†Ô∏è Warning Signs
- Zero relationships found
- Missing API key errors
- Low success rate
- No embeddings generated

### Common Issues

**No Relationships Found:**
- Files may not contain markdown links
- Relationship extraction regex may need enhancement
- Files may be standalone without cross-references

**Missing API Key Error:**
- Set `OPENAI_API_KEY` environment variable
- Required for embedding generation

**Low Success Rate:**
- Check file format compatibility
- Review error messages in report
- Ensure all dependencies are installed

## üí° Tips

1. **Run After Pipeline**: Always run this after the main RAG pipeline completes
2. **Regular Monitoring**: Generate reports regularly to track data quality
3. **Compare Reports**: Save reports with timestamps to track improvements
4. **Review Errors**: Focus on error analysis section to fix issues
5. **Check Relationships**: Zero relationships may indicate need for enhanced detection

## üõ†Ô∏è Customization

The Python script can be easily modified to:
- Add new analysis sections
- Change report format
- Filter specific file types
- Add custom metrics
- Export to different formats (JSON, CSV, HTML)

## üìö Related Documentation

- `RAG_PREPARATION_PLAN.md` - Overall RAG system architecture
- `RAG_QUICKSTART_GUIDE.md` - Getting started with the RAG system
- `INSTRUMENTATION_GUIDE.md` - Pipeline instrumentation details
- `RAG_LOCAL_POSTGRES_PLAN.md` - Database schema and setup

## üêõ Troubleshooting

**Error: "File not found: pipeline_metrics_detailed.json"**
- Make sure you've run the pipeline first
- Check you're in the correct directory
- Verify the metrics file was generated successfully

**Error: "Python is not installed or not in PATH"**
- Install Python 3.7+ from https://www.python.org/
- Add Python to your system PATH
- Restart your terminal/command prompt

**Report shows zero relationships**
- This is expected if files don't contain markdown links
- Consider enhancing relationship detection in the pipeline
- Review the recommendations section in the report

## üìû Support

For issues or questions about the relationship mapping report:
1. Check the Recommendations section in the generated report
2. Review related documentation listed above
3. Check pipeline execution logs for detailed error messages

---

**Last Updated**: October 3, 2025  
**Version**: 1.0.0

